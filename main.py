import os
import shutil
import xml.etree.ElementTree as ET

# Função para verificar e mover arquivos XML correspondentes
def mover_arquivos_iguais(lista_matriculas, pasta_origem, pasta_destino):
    # Cria a pasta destino se não existir
    if not os.path.exists(pasta_destino):
        os.makedirs(pasta_destino)
    
    # Itera pelos arquivos na pasta de origem
    for nome_arquivo in os.listdir(pasta_origem):
        if nome_arquivo.endswith(".xml"):
            caminho_arquivo = os.path.join(pasta_origem, nome_arquivo)
            try:
                tree = ET.parse(caminho_arquivo)
                root = tree.getroot()
                # Navega pela estrutura do XML até encontrar a matrícula
                namespace = {'ns': 'http://www.esocial.gov.br/schema/evt/evtAdmissao/v_S_01_02_00'}
                matricula = root.find('.//ns:matricula', namespace).text
                
                # Verifica se a matrícula está na lista
                if matricula in lista_matriculas:
                    # Move o arquivo para a pasta destino
                    shutil.move(caminho_arquivo, os.path.join(pasta_destino, nome_arquivo))
                    print(f"Arquivo {nome_arquivo} com matrícula {matricula} movido para {pasta_destino}")
            except Exception as e:
                print(f"Erro ao processar arquivo {nome_arquivo}: {e}")

# Exemplo de uso
lista_matriculas = [
"00014562",
"00014491",
"00014283",
"00014618",
"00014459",
"00014984",
"00015005",
"00014583",
"00014474",
"00014599",
"00015056",
"00014667",
"00014619",
"00014620",
"00014847",
"00014848",
"00000582"  ,
"00014249",
"00014826",
"00014300",
"00014600",
"00014707",
"00014253",
"00014012",
"00014013",
"00014051",
"00014058",
"00014969",
"00014978",
"00014971",
"00014060",
"00014280",
"00014982",
"00014286",
"00014308",
"00015022",
"00014318",
"00014827",
"00014987",
"00014808",
"00014420",
"00014421",
"00014425",
"00014427",
"00014436",
"00014455",
"00014990",
"00015026",
"00015027",
"00014457",
"00014458",
"00014461",
"00015029",
"00014065",
"00014902",
"00015030",
"00014492",
"00014493",
"00014515",
"00014525",
"00014791",
"00014526",
"00014856",
"00014966",
"00014527",
"00014528",
"00014893",
"00014948",
"00015019",
"00014981",
"00014935",
"00014979",
"00014034",
"00014946",
"00002765" ,
"00002908" ,
"00014422",
"00002756" ,
"00003961" ,
"00014041",
"00015025",
"00013965",
"00003991" ,
"00014196",
"00014894",
"00014278",
"00014089",
"00014276",
"00014475",
"00014248",
"00014750",
"00014644",
"00014955",
"00014480",
"00014943",
"00014977",
"00014481",
"00014991",
"00014091",
"00014654",
"00014434",
"00015057",
"00015032",
"00014449",
"00014880",
"00014407",
"00014928",
"00014197",
"00014954",
"00014699",
"00014252",
"00014961",
"00014018",
"00014993",
"00014539",
"00014507",
"00014431",
"00014448",
"00014499",
"00014456",
"00014574",
"00014639",
"00014671",
"00014224",
"00014952",
"00014938",
"00014930",
"00014565",
"00014432",
"00014470",
"00014989",
"00014956",
"00014655",
"00014714",
"00014673",
"00014511",
"00014569",
"00014217",
"00014478",
"00009922" ,
"00014483",
"00014262",
"00014263",
"00014028",
"00014724",
"00014535",
"00014417",
"00014622",
"00014489",
"00014541",
"00014472",
"00014533",
"00014285",
"00014423",
"00015028",
"00014587",
"00014428",
"00015009",
"00014697",
"00014433",
"00014516",
"00014588",
"00014517",
"00014643",
"00014261",
"00014496",
"00014840",
"00014809",
"00014466",
"00014445",
"00014560",
"00014951",
"00014430",
"00015040",
"00014976",
"00014610",
"00014999",
"00014945",
"00014942",
"00014941",
"00014194",
"00014953",
"00014608",
"00014933",
"00014665",
"00014998",
"00014905",
"00014907",
"00014570",
"00014558",
"00014633",
"00014614",
"00014898",
"00014980",
"00014257",
"00014275",
"00014518",
"00014295",
"00014468",
"00014656",
"00014579",
"00015037",
"00014231",
"00014208",
"00014054",
"00015060",
"00014376",
"00015001",
"00014023",
"00014247",
"00014239",
"00014022",
"00014908",
"00014237",
"00014863",
"00014858",
"00014909",
"00014236",
"00014259",
"00014256",
"00014243",
"00014409",
"00014245",
"00014238",
"00014823",
"00014759",
"00014378",
"00014512",
"00014868",
"00014009",
"00014010",
"00014011",
"00014014",
"00014015",
"00014016",
"00014017",
"00014019",
"00014029",
"00014020",
"00014021",
"00014024",
"00014027",
"00014030",
"00014031",
"00014032",
"00014035",
"00014036",
"00014037",
"00014038",
"00014039",
"00014040",
"00014042",
"00014043",
"00014045",
"00014046",
"00014048",
"00014049",
"00014050",
"00014052",
"00014053",
"00014055",
"00014056",
"00014057",
"00014061",
"00014062",
"00014063",
"00014066",
"00014067",
"00014068",
"00014069",
"00014070",
"00014093",
"00014094",
"00014095",
"00014097",
"00015035",
"00014225",
"00014274",
"00014277",
"00014279",
"00014281",
"00014282",
"00014284",
"00014289",
"00014290",
"00014292",
"00014293",
"00014294",
"00014296",
"00014700",
"00014305",
"00014399",
"00014408",
"00014410",
"00014899",
"00014437",
"00014444",
"00014447",
"00014450",
"00014452",
"00014453",
"00014454",
"00014463",
"00014465",
"00014467",
"00014469",
"00014471",
"00014473",
"00014476",
"00014477",
"00014482",
"00014487",
"00014488",
"00014495",
"00014497",
"00014500",
"00014501",
"00014502",
"00014504",
"00014505",
"00014506",
"00014508",
"00014509",
"00014513",
"00014514",
"00014519",
"00014520",
"00014521",
"00014522",
"00014523",
"00014524",
"00014532",
"00014529",
"00014530",
"00014534",
"00014531",
"00014537",
"00014536",
"00014540",
"00014543",
"00014544",
"00014545",
"00014547",
"00014548",
"00014549",
"00014550",
"00014551",
"00014553",
"00014554",
"00014555",
"00014556",
"00014702",
"00014559",
"00014561",
"00014564",
"00014566",
"00014567",
"00014568",
"00014571",
"00014572",
"00014573",
"00014575",
"00014576",
"00014578",
"00014577",
"00014580",
"00014581",
"00014582",
"00014584",
"00014585",
"00014586",
"00014590",
"00014648",
"00014591",
"00014607",
"00015053",
"00014606",
"00014609",
"00014626",
"00014613",
"00014623",
"00014615",
"00014625",
"00014627",
"00014629",
"00014635",
"00014630",
"00014631",
"00014636",
"00014632",
"00014634",
"00014637",
"00014638",
"00014641",
"00014649",
"00014642",
"00014664",
"00014646",
"00014659",
"00014653",
"00014661",
"00014658",
"00014668",
"00014663",
"00014704",
"00014669",
"00014696",
"00014672",
"00014683",
"00014828",
"00014695",
"00014698",
"00014703",
"00014829",
"00014838",
"00014834",
"00014842",
"00014836",
"00014837",
"00014845",
"00014841",
"00014843",
"00014846",
"00014849",
"00014852",
"00014850",
"00014853",
"00014874",
"00014854",
"00014855",
"00014875",
"00014857",
"00014869",
"00014876",
"00014878",
"00014897",
"00014879",
"00014890",
"00014900",
"00014892",
"00014895",
"00014896",
"00014901",
"00014903",
"00014904",
"00014910",
"00014911",
"00014914",
"00014915",
"00014919",
"00014937",
"00014921",
"00014931",
"00014932",
"00014936",
"00014963",
"00014947",
"00014950",
"00014959",
"00014964",
"00014967",
"00014970",
"00014968",
"00015003",
"00014972",
"00014974",
"00014975",
"00014992",
"00015000",
"00014994",
"00014995",
"00015002",
"00015011",
"00015006",
"00015015",
"00015014",
"00015012",
"00015013",
"00015020",
"00015018",
"00015016",
"00015024",
"00015021",
"00015023",
"00015039",
"00015034",
"00015044",
"00015042",
"00015041",
"00015049",
"00015048",
"00015045",
"00015046",
"00015052",
"00015050",
"00015054",
"00015059",
"00014913",
"00014210",
"00014206",
"00014851",
"00014223",
"00014088",
"00014246",
"00014214",
"00014226",
"00014230",
"00014872",
"00014215",
"00014706",
"00014870",
"00014871",
"00014944",
"00015008",
"00014186",
"00014605",
"00014985",
"00014603",
"00014183",
"00014705",
"00014071",
"00014957",
"00014255",
"00014218",
"00014099",
"00014708",
"00014650",
"00015038",
"00015010",
"00014077",
"00014082",
"00014198",
"00014640",
"00014510",
"00015055",
"00014076",
"00014081",
"00014660",
"00014083",
"00014080",
"00014973",
"00014462",
"00015007",
"00014888",
"00014657",
"00015058",
"00014538",
"00014986",
"00014377",
"00014887",
"00014624",
"00014645",
"00014542",
"00014195",
"00014297",
"00014929",
"00014219",
"00014220",
"00014222",
"00014202",
"00014201",
"00014221",
"00014078",
"00014709",
"00014085",
"00014074",
"00014299",
"00014073",
"00014460",
"00014302",
"00014298",
"00014498",
"00014251",
"00014958",
"00014207",
"00014701",
"00014593",
"00014418",
"00014203",
"00014250",
"00014047",
"00014758",
"00014757",
"00014084",
"00014811",
"00014265",
"00014254",
"00014807",
"00014087",
"00014188",
"00014301",
"00015047",
"00014440",
"00014464",
"00014486",
"00014589",
"00014611",
"00014616",
"00014617",
"00014662",
"00014925",
"00014940",
"00014965",
"00015043",
"00014090",
"00014044"
]

pasta_origem = "C:/Users/itarg/Downloads/s2200"  # Substitua pelo caminho da pasta de origem
pasta_destino = "C:/Users/itarg/Downloads/iguais"  # Substitua pelo caminho da pasta de destino

mover_arquivos_iguais(lista_matriculas, pasta_origem, pasta_destino)
